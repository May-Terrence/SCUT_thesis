\chapter{涵道风扇式无人机的系统建模与硬件设计}
%第二章：涵道风扇式无人机的系统建模与硬件设计。首先定义了DFUAV的坐标系和姿态表示方法，然后采用牛顿-欧拉方法推导出DFUAV的刚体运动学模型和刚体动力学模型，并分析了作用在涵道上的力与力矩。%最后介绍了DFUAV的硬件设计，包括传感器、执行器等。

本章的重点是对如图\Ref{DFUAV}所示的DFUAV进行系统建模，这将是后续进行飞行控制算法设计的基础。在无人机的建模分析中，为简化模型复杂度并且便于控制算法的设计，有必要假设无人机是刚体。物体的相对运动离不开其所处的参考坐标系，因此本章将先介绍本文所使用的多坐标系描述方法以及姿态表示方法。然后采用在刚体上应用广泛的牛顿-欧拉方法推导出DFUAV的刚体运动学模型和动力学模型，得到飞行控制的刚体模型。最后分析了作用在涵道上的力与力矩。%最后介绍了DFUAV的硬件设计，包括传感器、执行器等。

DFUAV的系统建模中各变量定义标准主要参考文献\parencite{杨一栋2019直升机飞行控制}，并为了表示方便，避免混淆，对部分变量的表示作略微修改。
\begin{figure}[htbp]
	\centering
	\begin{minipage}[c]{1\textwidth} % minipage将页面划分为0.5\textwidth
		\centering
		\includegraphics[scale=1]{Fig/DFUAV.jpg}
		\caption{\label{DFUAV}本文研究所使用的DFUAV}
	\end{minipage}%
\end{figure}

\section{坐标系和姿态表示方法}

考虑到无人机的位置变化与姿态变化，基于地面坐标系($\boldsymbol{O}_e-\boldsymbol{X}_e\boldsymbol{Y}_e\boldsymbol{Z}_e $)和机体坐标系(${\boldsymbol{O}_b}-{\boldsymbol{X}_b}{\boldsymbol{Y}_b}{\boldsymbol{Z}_b}$)的多坐标系表示法被广泛采用。

\begin{enumerate}[topsep = 0 pt, itemsep= 0 pt, parsep=0pt, partopsep=0pt, leftmargin=44pt, itemindent=0pt, labelsep=6pt, label=(\arabic*)]
	\item 地面坐标系

    地面坐标系的原点$\boldsymbol{O}_e$可以是地平面上的任意一点，一般定义为无人机的起飞点。三轴方向分别为$\boldsymbol{O}_e-\boldsymbol{X}_e$轴在地平面内指向地理正北方向（N），$\boldsymbol{O}_e-\boldsymbol{Y}_e$轴在地平面内指向地理正东方向（E），$\boldsymbol{O}_e-\boldsymbol{Z}_e$轴按照右手定则，垂直于地面指向地心，方向向下（D）。因此地面坐标系也被称为北东地（NED）坐标系，该坐标系与地球固连。

	\item 机体坐标系
	
    机体坐标系与无人机的机体固连，其原点$\boldsymbol{O}_b$定义为无人机的重心位置。三轴方向分别为$\boldsymbol{O}_b-\boldsymbol{X}_b$轴在无人机对称平面内指向人为定义的机头方向，$\boldsymbol{O}_b-\boldsymbol{Z}_b$轴在无人机对称平面内垂直于$\boldsymbol{O}_b-\boldsymbol{X}_b$轴向下为正，$\boldsymbol{O}_b-\boldsymbol{Y}_b$轴按照右手定则与$\boldsymbol{X}_b-\boldsymbol{O}_b-\boldsymbol{Z}_b$平面垂直，沿着机身的右侧方向向右为正。
\end{enumerate}

地面坐标系和机体坐标系定义如图\ref{坐标系}所示。同一个物理量在不同的坐标系中有不同的大小和方向，为便于区分，在全文中统一使用上标$(.)^{e}$与$(.)^{b}$表示同一个物理量在地面坐标系和机体坐标系下的表示。

在地面坐标系下采用惯性/GPS导航等方式，无人机的位置和速度等运动状态可以方便直观地映射到地理空间中。无人机的重心相对于地面坐标系的位置矢量在地面坐标系下表示为$\boldsymbol{P}^{e}=\begin{bmatrix}{x}^{e}&{y}^{e}&{z}^{e}\end{bmatrix}^{T}$，机体重心沿着地面坐标系的速度矢量在地面坐标系下表示为$\boldsymbol{V}^{e}=\begin{bmatrix}{v}^{e}_{x}&{v}^{e}_{y}&{v}^{e}_{z}\end{bmatrix}^{T}$，机体重心相对于地面坐标系的速度矢量在机体坐标系下表示为$\boldsymbol{V}^{b}=\begin{bmatrix}{u}&{v}&{w}\end{bmatrix}^{T}$。

地面坐标系与机体坐标系的旋转变化关系体现了无人机的姿态变化，无人机常用的姿态描述方法有欧拉角、旋转矩阵和四元数等方式。其中欧拉角表示方法因物理意义明确，表示直观，所以被广泛采用。但因其奇异性问题\cite{全权2018多旋翼飞行器设计与控制}，欧拉角表示法在一些特殊场景的使用下受到制约（如横滚角或者俯仰角为90°的情况）。考虑到本研究在姿态控制中，由于输入姿态指令和输出舵面角度的约束，不会出现上述奇异情况，所以本文采用欧拉角来描述无人机的姿态。根据欧拉定理，地面坐标系按照某个固定点经过三次基本旋转可以得到机体坐标系。由于旋转运动与坐标系原点的位置无关，所以为便于理解，将地面坐标系的原点与机体坐标系原点重合（即$\boldsymbol{O}_e=\boldsymbol{O}_b$），如图\ref{欧拉角}所示。在三次基本旋转中，旋转轴是待转动坐标系的某一轴，旋转的角度即为欧拉角。由于姿态旋转矩阵可以表示为三次基本旋转的乘积，所以与旋转顺序密切相关。由于本研究不会出现奇异问题，所以本文采用常用的‘ZYX’的旋转顺序的欧拉角表示法。

\begin{figure}[htbp]
	\centering
	\begin{minipage}[c]{0.5\textwidth}
		\centering
		\includegraphics[scale=1]{Fig/演示文稿1.pdf}
		\caption{\label{坐标系}地面坐标系与机体坐标系定义}
	\end{minipage}%
    \begin{minipage}[c]{0.5\textwidth}
		\centering
		\includegraphics[scale=1]{Fig/演示文稿2.pdf}
		\caption{\label{欧拉角}‘ZYX’欧拉角的定义}
	\end{minipage}%
\end{figure}

在图\ref{欧拉角}中，地面坐标系$\boldsymbol{O}_e-\boldsymbol{X}_e\boldsymbol{Y}_e\boldsymbol{Z}_e$首先围绕$\boldsymbol{Z}_e$轴旋转偏航角$\psi$，向右偏航为正方向。此时$\boldsymbol{X}_e$轴旋转至$\boldsymbol{X}_e^{'}$轴，$\boldsymbol{Y}_e$轴旋转至$\boldsymbol{Y}_e^{'}$轴，$\boldsymbol{Z}_e$轴保持不变；
然后临时坐标系$\boldsymbol{O}_e-\boldsymbol{X}_e^{'}\boldsymbol{Y}_e^{'}\boldsymbol{Z}_e$围绕$\boldsymbol{Y}_e^{'}$轴旋转俯仰角$\theta$，上仰为正方向。此时$\boldsymbol{X}_e^{'}$轴旋转至$\boldsymbol{X}_b$轴，与机体系保持一致，$\boldsymbol{Z}_e$轴旋转至$\boldsymbol{Z}_e^{'}$轴，$\boldsymbol{Y}_e^{'}$轴保持不变；
最后临时坐标系$\boldsymbol{O}_e-\boldsymbol{X}_b\boldsymbol{Y}_e^{'}\boldsymbol{Z}_e^{'}$围绕$\boldsymbol{X}_b$轴旋转滚转角$\varphi$，向右滚转为正方向。此时$\boldsymbol{Y}_e^{'}$轴旋转至$\boldsymbol{Y}_b$轴，$\boldsymbol{Z}_e^{'}$轴旋转至$\boldsymbol{Z}_b$轴，均与机体系保持一致。

三次基本旋转的角度分别为$\psi$、$\theta$、$\varphi$，定义其对应的旋转矩阵分别为$\boldsymbol{R}_\psi,\boldsymbol{R}_\theta,\boldsymbol{R}_\varphi\in{SO(3)}$，其中$SO(3)=\{R\in\mathbb{R}^{3\times3}|RR^T=I,|R|=1\}$。
\begin{equation}
    \begin{aligned} %表示公式编号上下居中
\boldsymbol{R}_\psi=\begin{bmatrix}\cos\psi & \sin\psi & 0 \\-\sin\psi & \cos\psi & 0 \\0 & 0 & 1\end{bmatrix},\boldsymbol{R}_\theta=\begin{bmatrix}\cos\theta & 0 & -\sin\theta \\0 & 1 & 0 \\\sin\theta & 0 & \cos\theta\end{bmatrix},\boldsymbol{R}_\varphi=\begin{bmatrix}1 & 0 & 0\\0 & \cos\varphi & \sin\varphi \\0 & -\sin\varphi & \cos\varphi\end{bmatrix}
    \end{aligned}
\end{equation}

为表述方便，定义如下单位向量：
\begin{equation}
    \begin{aligned}
\boldsymbol{e}_1=\begin{bmatrix}1 \\0 \\0\end{bmatrix},
\quad\boldsymbol{e}_2=\begin{bmatrix}0 \\1 \\0\end{bmatrix},
\quad\boldsymbol{e}_3=\begin{bmatrix}0 \\0 \\1\end{bmatrix}
    \end{aligned}
\end{equation}

机体姿态的欧拉角表示为$\boldsymbol{\eta}=\begin{bmatrix}\varphi& \theta & \psi\end{bmatrix}^T$，对应的姿态变化率为$\boldsymbol{\dot{\eta}}=[\dot{\varphi} \quad \dot{\theta} \quad \dot{\psi}]^T$。


\LaTeX{}的源代码保存在后缀名为.tex的文件中。当编写长篇文档时，例如当编写书籍、毕业论文时，单个源文件会使修改、校对变得十分困
难。将源文件分割成若干个文件，例如将每章内容单独写在一个文件中，会大大简化修改和校对
的工作。为方便，本文将scutthesis.tex文件称为主文件，而将chapter文件夹的abstract.tex、chapter0x.tex、conclusion.tex等文件称为章节文件。

值得注意的是，要每次编译时都更新参考文献著录，TeXstudio软件的选项->设置中的构建并查看、编译器需要设置成如图\ref{TeXstudio}、\ref{setup}所示。此时只需在任意一个文件中点击构建并查看按钮即可编译文档。每次编译都更新参考文献会使得编译时间很长。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.55]{Fig/TeXstudio.png}
	\caption{\label{TeXstudio}TeXstudio环境}
\end{figure}
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.55]{Fig/setup.png}
	\caption{\label{setup}TeXstudio编译选项}
\end{figure}

\section{主文件}
scutthesis.tex文件相当于主函数，调用各章的内容。\LaTeX{}源代码以一个\textbackslash{}documentclass 命令作为开头，它指定了文档使用的文档类。文档类规定了\LaTeX{}源代码所要生成的文档的性质——普通文章、书籍、演示文稿、个人简
历等等。
\begin{lstlisting}
\documentclass[<options>]{<class-name>}
\end{lstlisting}
其中class-name为文档类的名称，如\LaTeX{}提供的article, book, report，可在其基础上派
生的一些文档类或者有其它功能的一些文档类。\LaTeX{}提供的基础文档类见文献\parencite{_c}。还可以自定义文档类，如华南理工大学硕博士论文文档类scutthesis，其实现保存在后缀名为.cls的文件中。可选参数options 为文档类指定选项。


document环境当中的内容是文档正文：
\begin{lstlisting}
\begin{document}
正文内容
\end{document}
\end{lstlisting}
正文中包含各章节内容：
\begin{lstlisting}
\include{abstract} % 中英文摘要
\tableofcontents	% 目录
\listoftables	% 表格目录（可选）
\listoffigures	% 插图目录（可选）
\include{symbols}	% 符号对照表(可选)
\include{abbreviation} 	% 缩略词	
...
\include{chapter01}	% 第一章
\include{chapter02} % 第二章
\include{chapter03} % 第三章
% 自行根据需要添加章节。
...
\include{conclusion} % 结论
...
\printbibliography	% 参考文献著录
\include{appendix} % 附录
\include{pub} % 成果
\include{ack} % 致谢
\end{lstlisting}
其中$\%$之后的内容为注释，...表示省略其他代码，仅保留论文内容主体部分。\textbackslash{}include\{xxx\}指令用于包含xxx.tex文件的内容，各章节的内容主要在xxx.tex中保存。在\textbackslash{}documentclass 和\textbackslash{}begin\{document\} 之间的位置称为导言区。在导言区中一般会使用\textbackslash{}usepackage 调用宏包，以及会进行对文档的全局设置。本模板的导言区除调用所需的宏包外，还进行了页眉页脚的设置。有的模板会把所有调用宏包的指令放到一个.sty宏包文件中，页面的设置放在文档类文件.cls文件中。因本人时间有限，就不做整理，欢迎有志之士加入完善。使用本模板并不需要了解导言区的指令，在需要时额外添加即可（要注意宏包冲突）。特别地，\textbackslash{}includeonly\{xxx\}指令用于使文档仅编译xxx.tex文件的内容，这就是分章节包含（include）的好处，可大大减少编译时间。

将封面打印保存为 thesis\_cover.pdf 文件，硕士使用master\_cover.docx ，博士使用 doctor\_cover.doc 。如果有更新版本的封面，可自行替换。文档类默认是博士论文，下面指令将控制添加封面与否：
\begin{lstlisting}
\documentclass[unicode,master,pdfcover]{scutthesis}	% 使用pdf文件封面的 硕士模板
\documentclass[unicode,master]{scutthesis}	% 不使用pdf文件封面的 硕士模板
\documentclass[unicode,pdfcover]{scutthesis}	% 使用pdf文件封面的博士模板
\documentclass[unicode]{scutthesis}	% 不使用pdf文件封面的博士模板
\end{lstlisting}
不使用thesis\_cover.pdf 文件指定的封面时，将使用草稿封面。草稿封面也可以减少编译时间，因此可以在最终提交论文时再使用论文封面。草稿封面用以下指令设置：
\begin{lstlisting}
%%%%%%%%%%%%%草稿封面设置%%%%%%%%%%%%%	
\title{LaTeX模板}	
\author{作者姓名}	
\supervisor{指导教师：xxx\ 教授}	
\institute{华南理工大学}	
\date{2020年5月20日}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{lstlisting}
\section{章节文件}
chapter文件夹的章节文件如chapter0x.tex等，其内容由\textbackslash{}chapter\{章名\}开头。新建一章可新建一个文件并由\textbackslash{}chapter\{新建章名\}开头填写内容即可。节及小节分别用\textbackslash{}section\{新建节名\}、\textbackslash{}subsection\{新建小节名\}命令。

正文的的书写和txt文本文件的书写类似。\LaTeX{} 源代码中，空格键和Tab键输入的空白字符视为“空格”。连续的若干个空白字符视为一个空格。一行开头的空格忽略不计。行末的回车视为一个空格；但连续两个回车，也就是空行，会将文字分段。多个空行被视为一个空行。也可以在行末使用\textbackslash{}par 命令分段。在本模板中，英文之间的空格被保留，中文之间的空格被忽略。特别地，摘要，附录，结论等两个字的大纲级别为章的章名，中间使用空格隔开。对此论文撰写规范并没有明文要求，只是为了美观。也可以全部不加空格。一般情况下，在文本文字中添加空格使用\textbackslash{}quad命令，但由于文献\parencite{_d}所述原因，直接使用\textbackslash{}quad命令会报警，因而使用\textbackslash{}texorpdfstring\{\textbackslash{}quad\}\{\}，其中最后一个\{\}里面可以加一个空格，不影响使用。目录二字之间添加空格在scutthesis.cls文件317行设置。

正文本环境中使用公式，即行内公式，需要用两个\$包围，如源码：\$a+b=c\$ 显示为$a+b=c$。使用其他字符可自行百度或阅读参考文献。再次提醒，使用\LaTeX{}撰写论文不需要研究其原理，在达到某种效果（图文显示、公式显示效果）时百度或查书寻找其代码即可。

综上，论文撰写只需要将自己的文本（包含行内公式）放到相应的章节处，并添加行间公式、图表环境并填写图表即可。行间公式、图表将在下一章介绍。

